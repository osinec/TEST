<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>–£–º–Ω—ã–π –ø–æ–∏—Å–∫ —Ä–µ—Ü–µ–ø—Ç–æ–≤</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(135deg, #ffecd2, #fcb69f);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      color: #222;
      padding: 30px 16px;
    }
    .card {
      width: 100%;
      max-width: 540px;
      background: rgba(255,255,255,.96);
      border-radius: 26px;
      padding: 32px 28px;
      box-shadow: 0 30px 70px rgba(0,0,0,.18);
    }
    .back-btn {
      padding: 14px 24px;
      background: linear-gradient(135deg, #a0d8ef, #b8e0f8);
      color: #222;
      width: 100%;
      border: none;
      border-radius: 40px;
      cursor: pointer;
      font-weight: 800; /* –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –∂–∏—Ä–Ω—ã–π */
      margin-bottom: 16px;
      font-size: 16px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    h1 {
      font-size: 26px;
      font-weight: 700;
      text-align: center;
      margin-bottom: 28px;
      color: #d35400;
    }
    .ingredients-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
      gap: 10px;
      margin-bottom: 20px;
    }
    .ingredient-item {
      display: flex; align-items: center; gap: 8px; padding: 10px;
      background: #fdfaf7; border: 1px solid #f4d3b5; border-radius: 12px;
      cursor: pointer; font-size: 14px; transition: 0.2s;
    }
    .ingredient-item:has(input:checked) { background: #fff8f2; border-color: #f4a261; }
    
    .main-btn {
      padding: 18px; background: linear-gradient(135deg, #f6d365, #fda085);
      width: 100%; border-radius: 40px; border: none; font-weight: 700; font-size: 17px;
      cursor: pointer; margin-bottom: 10px;
    }
    .main-btn:disabled { opacity: 0.5; }

    .refresh-btn {
      padding: 16px; background: linear-gradient(135deg, #4caf50, #66bb6a);
      color: white; width: 100%; border-radius: 40px; border: none; font-weight: 700;
      cursor: pointer; display: none; margin-bottom: 20px;
    }

    .recipe-card {
      background: white; border-radius: 20px; overflow: hidden;
      border: 1px solid #eee; margin-top: 20px; animation: fadeIn 0.4s ease;
    }
    @keyframes fadeIn { from {opacity: 0; transform: translateY(10px);} to {opacity: 1; transform: translateY(0);} }
    
    .recipe-card img { width: 100%; height: 220px; object-fit: cover; }
    .recipe-info { padding: 20px; }
    .recipe-title { font-size: 22px; font-weight: 700; color: #d35400; margin-bottom: 10px; }
    
    .ing-tag { padding: 5px 10px; border-radius: 8px; font-size: 13px; display: inline-block; margin: 3px; }
    .have { background: #e3fcef; color: #27ae60; font-weight: 600; }
    .missing-main { background: #ffe3e3; color: #eb4d4b; border: 1px solid #ffcccc; font-weight: 700; }
    .missing-extra { background: #f1f2f6; color: #b2bec3; text-decoration: line-through; opacity: 0.7; }
    
    .steps-box { margin-top: 15px; font-size: 15px; line-height: 1.6; color: #444; border-top: 1px solid #eee; padding-top: 10px; }
  </style>
</head>
<body>

<div class="card">
  <button class="back-btn" onclick="window.history.back()">‚Üê –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é</button>
  <h1>–ß—Ç–æ –µ—Å—Ç—å –¥–æ–º–∞?</h1>

  <div class="ingredients-grid" id="ingredientsList"></div>
  
  <button class="main-btn" id="findBtn" disabled>–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ä–µ—Ü–µ–ø—Ç</button>
  <button class="refresh-btn" id="refreshBtn">–î—Ä—É–≥–æ–π –≤–∞—Ä–∏–∞–Ω—Ç</button>

  <div id="results"></div>
</div>

<script>
const CATALOG = [
  {id: "eggs", name: "–Ø–π—Ü–∞"}, {id: "mushrooms", name: "–ì—Ä–∏–±—ã"}, {id: "onion", name: "–õ—É–∫"},
  {id: "bran", name: "–û—Ç—Ä—É–±–∏"}, {id: "cottage_cheese", name: "–¢–≤–æ—Ä–æ–≥"}, {id: "lavash", name: "–õ–∞–≤–∞—à"},
  {id: "cheese", name: "–°—ã—Ä"}, {id: "tomato", name: "–ü–æ–º–∏–¥–æ—Ä—ã"}, {id: "fish", name: "–†—ã–±–∞"}
];

let selected = new Set();
let foundRecipes = [];
let currentIdx = 0;

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–ø–∏—Å–∫–∞ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤
function init() {
  const grid = document.getElementById('ingredientsList');
  grid.innerHTML = CATALOG.map(i => `
    <label class="ingredient-item">
      <input type="checkbox" value="${i.id}" onchange="toggleIng('${i.id}')">
      <span>${i.name}</span>
    </label>
  `).join('');
}

function toggleIng(id) {
  if (selected.has(id)) selected.delete(id); else selected.add(id);
  document.getElementById('findBtn').disabled = selected.size === 0;
  document.getElementById('refreshBtn').style.display = 'none';
}

// –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Ä–µ—Ü–µ–ø—Ç–∞
function renderRecipe(recipe) {
  const tags = recipe.ingredients.map(ing => {
    const has = selected.has(ing.id);
    let cls = has ? 'have' : (ing.isMain ? 'missing-main' : 'missing-extra');
    let text = has ? ing.name : (ing.isMain ? ing.name + " (–Ω—É–∂–Ω–æ!)" : ing.name);
    return `<span class="ing-tag ${cls}">${text}</span>`;
  }).join('');

  document.getElementById('results').innerHTML = `
    <div class="recipe-card">
      <img src="${recipe.photo}" onerror="this.src='https://via.placeholder.com/500x300?text=–ù–µ—Ç+—Ñ–æ—Ç–æ'">
      <div class="recipe-info">
        <div class="recipe-title">${recipe.title}</div>
        <p style="color:#666; font-size:14px; margin-bottom:12px;">‚è± ${recipe.time} | üî• ${recipe.calories} –∫–∫–∞–ª</p>
        <div>${tags}</div>
        <div class="steps-box">
          <strong>–ü—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏–µ:</strong><br>
          ${recipe.steps.map((s,i) => `${i+1}. ${s}`).join('<br>')}
        </div>
      </div>
    </div>
  `;
}

// –ó–∞–≥—Ä—É–∑–∫–∞ JSON –∏ –ø–æ–∏—Å–∫
document.getElementById('findBtn').onclick = async () => {
  try {
    const response = await fetch('breakfast.json');
    const recipes = await response.json();

    foundRecipes = recipes.filter(r => {
      const mains = r.ingredients.filter(i => i.isMain);
      const matched = mains.filter(i => selected.has(i.id)).length;
      return (matched / mains.length) >= 0.75; // –£—Å–ª–æ–≤–∏–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è
    }).sort(() => Math.random() - 0.5);

    if (foundRecipes.length > 0) {
      currentIdx = 0;
      renderRecipe(foundRecipes[currentIdx]);
      if (foundRecipes.length > 1) document.getElementById('refreshBtn').style.display = 'block';
    } else {
      document.getElementById('results').innerHTML = '<p style="text-align:center; padding:20px; color:#666;">–ü–æ —ç—Ç–∏–º –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–∞–º –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤—ã–±—Ä–∞—Ç—å –¥—Ä—É–≥–∏–µ.</p>';
    }
  } catch (err) {
    console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ JSON:", err);
    alert("–ü–æ–ª–æ–∂–∏—Ç–µ —Ñ–∞–π–ª breakfast.json –≤ —Ç—É –∂–µ –ø–∞–ø–∫—É, —á—Ç–æ –∏ —ç—Ç–æ—Ç HTML!");
  }
};

document.getElementById('refreshBtn').onclick = () => {
  currentIdx = (currentIdx + 1) % foundRecipes.length;
  renderRecipe(foundRecipes[currentIdx]);
};

init();
</script>
</body>
</html>
