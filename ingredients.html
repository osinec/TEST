<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>–†–µ—Ü–µ–ø—Ç—ã –ø–æ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–∞–º</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Inter', system-ui, sans-serif;
      background: linear-gradient(135deg, #ffecd2, #fcb69f);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      color: #222;
      padding: 30px 16px;
    }
    .card {
      width: 100%;
      max-width: 540px;
      background: rgba(255,255,255,.96);
      border-radius: 26px;
      padding: 32px 28px;
      box-shadow: 0 30px 70px rgba(0,0,0,.18);
    }
    h1 {
      font-size: 26px;
      font-weight: 700;
      text-align: center;
      margin: 0 0 28px;
      line-height: 1.3;
      color: #d35400;
    }
    .section-title {
      text-align: left;
      font-size: 17px;
      font-weight: 600;
      color: #333;
      margin: 24px 0 14px;
    }
    .ingredients-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(148px, 1fr));
      gap: 10px 12px;
      margin-bottom: 20px;
    }
    .ingredient-item {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 12px 14px;
      background: #fdfaf7;
      border: 1px solid #f4d3b5;
      border-radius: 14px;
      cursor: pointer;
      transition: all 0.22s;
      user-select: none;
    }
    .ingredient-item:hover {
      background: #fff8f2;
      border-color: #f4a261;
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(244,162,97,0.12);
    }
    .ingredient-item input[type="checkbox"] {
      width: 18px;
      height: 18px;
      accent-color: #f4a261;
    }
    .ingredient-item span {
      font-size: 15px;
      line-height: 1.4;
      color: #444;
    }
    button {
      font-family: 'Inter', sans-serif;
      cursor: pointer;
      border: none;
      border-radius: 40px;
      font-weight: 600;
      transition: all .3s;
      -webkit-tap-highlight-color: transparent;
    }
    .main-btn {
      padding: 18px 32px;
      background: linear-gradient(135deg, #f6d365, #fda085);
      font-size: 17px;
      color: #222;
      width: 100%;
      margin: 16px 0 12px;
    }
    .main-btn:disabled {
      opacity: 0.55;
      cursor: not-allowed;
    }
    .main-btn:not(:disabled):hover,
    .main-btn:not(:disabled):active {
      transform: translateY(-2px);
      box-shadow: 0 10px 20px rgba(0,0,0,.15);
    }
    .back-btn {
      padding: 14px 24px;
      background: linear-gradient(135deg, #a0d8ef, #b8e0f8);
      color: #222;
      font-size: 16px;
      width: 100%;
      margin-bottom: 24px;
    }
    .back-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 16px rgba(160,216,239,0.4);
    }
    .secondary-btn {
      padding: 16px 28px;
      background: linear-gradient(135deg, #e0e0e0, #d0d0d0);
      color: #444;
      font-size: 16px;
      width: 100%;
    }
    .secondary-btn:hover {
      background: linear-gradient(135deg, #d0d0d0, #c0c0c0);
    }
    .recipe-card {
      background: #fffef9;
      border-radius: 16px;
      padding: 20px;
      margin: 24px 0;
      border: 1px solid #f0e8e0;
      box-shadow: 0 6px 16px rgba(0,0,0,0.07);
    }
    .recipe-title {
      font-size: 21px;
      font-weight: 700;
      color: #c7903d;
      margin-bottom: 12px;
    }
    .recipe-meta {
      font-size: 14.5px;
      color: #666;
      margin-bottom: 16px;
      line-height: 1.5;
    }
    .plain-list {
      text-align: left;
      font-size: 15.5px;
      line-height: 1.65;
      color: #333;
      margin: 12px 0 20px;
      white-space: pre-wrap;
    }
    .note {
      text-align: left;
      margin-top: 20px;
      font-size: 15px;
      color: #555;
      font-style: italic;
      padding: 14px 16px;
      background: #fdfaf7;
      border-left: 4px solid #f4a261;
      border-radius: 8px;
      line-height: 1.6;
    }
    .note strong { color: #d35400; font-style: normal; }
    .no-results, .loader {
      text-align: center;
      padding: 40px 20px;
      color: #666;
      font-size: 16.5px;
      line-height: 1.6;
    }
    .error {
      color: #d32f2f;
      background: #ffebee;
      padding: 12px 16px;
      border-radius: 10px;
      margin: 16px 0;
      font-size: 15px;
      text-align: center;
    }
    .auth-form {
      display: none;
      margin-bottom: 24px;
    }
    .auth-form input {
      width: 100%;
      padding: 12px 16px;
      margin: 8px 0;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-size: 15px;
    }
    .auth-btn {
      margin-top: 12px;
    }
    .toggle-auth {
      font-size: 14px;
      color: #666;
      text-align: center;
      margin-top: 12px;
      cursor: pointer;
    }
    .toggle-auth span {
      color: #d35400;
      text-decoration: underline;
    }
    @media (max-width: 380px) {
      .card { padding: 24px 20px; border-radius: 20px; }
      h1 { font-size: 23px; }
      .ingredients-grid { grid-template-columns: 1fr 1fr; }
    }
  </style>
</head>
<body>
<div class="card">
  <button class="back-btn" onclick="window.location.href='index.html'">
    ‚Üê –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é
  </button>
  <h1>–†–µ—Ü–µ–ø—Ç—ã –ø–æ –∏–º–µ—é—â–∏–º—Å—è –ø—Ä–æ–¥—É–∫—Ç–∞–º</h1>
  
  <!-- –§–æ—Ä–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ -->
  <div id="authSection" class="auth-form">
    <input type="email" id="email" placeholder="Email" required>
    <input type="password" id="password" placeholder="–ü–∞—Ä–æ–ª—å" required>
    <button class="main-btn auth-btn" id="authBtn">–í–æ–π—Ç–∏</button>
    <div class="toggle-auth" id="toggleAuth">
      –ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? <span>–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</span>
    </div>
    <div class="error" id="authError" style="display: none;"></div>
  </div>
  
  <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç (—Å–∫—Ä—ã—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
  <div id="mainContent" style="display: none;">
    <div class="section-title">–û—Ç–º–µ—Ç—å—Ç–µ, —á—Ç–æ –µ—Å—Ç—å –¥–æ–º–∞:</div>
    <div class="ingredients-grid" id="ingredientsList"></div>
    <button class="main-btn" id="findRecipesBtn" disabled>–ù–∞–π—Ç–∏ –ø–æ–¥—Ö–æ–¥—è—â–∏–µ —Ä–µ—Ü–µ–ø—Ç—ã</button>
    <button class="secondary-btn" id="clearBtn">–°–±—Ä–æ—Å–∏—Ç—å –≤—ã–±–æ—Ä</button>
    <button class="secondary-btn" id="logoutBtn" style="margin-top: 12px;">–í—ã–π—Ç–∏</button>
    <div id="results">
      <div class="loader" id="loader" style="display:none">–ü–æ–∏—Å–∫ —Ä–µ—Ü–µ–ø—Ç–æ–≤...</div>
    </div>
  </div>
  
  <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –∏—Å—Ç–µ–∫—à–µ–º —Ç—Ä–∏–∞–ª–µ -->
  <div id="trialExpired" style="display: none;" class="note">
    <strong>–í–∞—à —Ç–µ—Å—Ç–æ–≤—ã–π –ø–µ—Ä–∏–æ–¥ –∏—Å—Ç–µ–∫.</strong><br>
    –î–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –æ—Ñ–æ—Ä–º–∏—Ç–µ –ø–æ–¥–ø–∏—Å–∫—É.
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/pocketbase/dist/pocketbase.umd.js"></script>
<script type="module">
// ‚îÄ‚îÄ‚îÄ –ù–ê–°–¢–†–û–ô–ö–ò ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const PB_URL = 'http://your-pocketbase-server:8090'; // –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ URL –≤–∞—à–µ–≥–æ PocketBase —Å–µ—Ä–≤–µ—Ä–∞
const pb = new PocketBase(PB_URL);

const CATEGORIES = ['breakfast', 'lunch', 'dinner', 'soups', 'dessert'];
const POPULAR_INGREDIENTS = [
  "—è–π—Ü–∞", "–º–æ–ª–æ–∫–æ", "—Å–∞—Ö–∞—Ä", "–º—É–∫–∞", "–º–∞—Å–ª–æ —Å–ª–∏–≤–æ—á–Ω–æ–µ", "–º–∞—Å–ª–æ —Ä–∞—Å—Ç–∏—Ç–µ–ª—å–Ω–æ–µ",
  "–∫—É—Ä–∏—Ü–∞", "–≥–æ–≤—è–¥–∏–Ω–∞", "—Å–≤–∏–Ω–∏–Ω–∞", "—Ä—ã–±–∞", "–∫–∞—Ä—Ç–æ—Ñ–µ–ª—å", "–º–æ—Ä–∫–æ–≤—å", "–ª—É–∫",
  "–ø–æ–º–∏–¥–æ—Ä—ã", "–æ–≥—É—Ä—Ü—ã", "–∫–∞–ø—É—Å—Ç–∞", "—Ä–∏—Å", "–≥—Ä–µ—á–∫–∞", "–º–∞–∫–∞—Ä–æ–Ω—ã", "–æ–≤—Å—è–Ω–∫–∞",
  "—Ç–≤–æ—Ä–æ–≥", "—Å—ã—Ä", "—Å–º–µ—Ç–∞–Ω–∞", "–∫–µ—Ñ–∏—Ä", "–π–æ–≥—É—Ä—Ç", "—è–±–ª–æ–∫–∏", "–±–∞–Ω–∞–Ω—ã",
  "–∞–ø–µ–ª—å—Å–∏–Ω—ã", "–ª–∏–º–æ–Ω", "—á–µ—Å–Ω–æ–∫", "–∑–µ–ª–µ–Ω—å", "—É–∫—Ä–æ–ø", "–ø–µ—Ç—Ä—É—à–∫–∞", "—Å–ø–µ—Ü–∏–∏",
  "—Å–æ–ª—å", "–ø–µ—Ä–µ—Ü", "–º—ë–¥", "—à–æ–∫–æ–ª–∞–¥", "–∫–∞–∫–∞–æ", "—Ä–∞–∑—Ä—ã—Ö–ª–∏—Ç–µ–ª—å", "—Å–æ–¥–∞"
];
// ‚îÄ‚îÄ‚îÄ –≠–ª–µ–º–µ–Ω—Ç—ã ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const authSection = document.getElementById('authSection');
const mainContent = document.getElementById('mainContent');
const trialExpired = document.getElementById('trialExpired');
const authBtn = document.getElementById('authBtn');
const toggleAuth = document.getElementById('toggleAuth');
const authError = document.getElementById('authError');
const emailInput = document.getElementById('email');
const passwordInput = document.getElementById('password');
const logoutBtn = document.getElementById('logoutBtn');

const ingListEl = document.getElementById('ingredientsList');
const findBtn = document.getElementById('findRecipesBtn');
const clearBtn = document.getElementById('clearBtn');
const resultsEl = document.getElementById('results');
const loaderEl = document.getElementById('loader');
// ‚îÄ‚îÄ‚îÄ –°–æ—Å—Ç–æ—è–Ω–∏–µ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
let selected = new Set();
let isRegisterMode = false;
// ‚îÄ‚îÄ‚îÄ –§—É–Ω–∫—Ü–∏–∏ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function renderIngredients() {
  ingListEl.innerHTML = '';
  POPULAR_INGREDIENTS.forEach(name => {
    const label = document.createElement('label');
    label.className = 'ingredient-item';
    const cb = document.createElement('input');
    cb.type = 'checkbox';
    cb.addEventListener('change', e => {
      if (e.target.checked) selected.add(name.toLowerCase());
      else selected.delete(name.toLowerCase());
      findBtn.disabled = selected.size === 0;
    });
    const span = document.createElement('span');
    span.textContent = name;
    label.append(cb, span);
    ingListEl.appendChild(label);
  });
}
async function loadAllRecipes() {
  const all = [];
  for (const cat of CATEGORIES) {
    try {
      const r = await fetch(`recipes/${cat}.json`);
      if (!r.ok) continue;
      const data = await r.json();
      data.forEach(recipe => { recipe.category = cat; });
      all.push(...data);
    } catch {}
  }
  return all;
}
function normalize(str) {
  return (str || '').toLowerCase()
    .replace(/—ë/g, '–µ')
    .replace(/[^–∞-—è0-9\s]/gi, '')
    .trim();
}
function matchesRecipe(recipe, selectedSet) {
  if (!recipe.ingredients?.length) return false;
  const recipeNorm = recipe.ingredients.map(i => normalize(i));
  let hitCount = 0;
  for (const s of selectedSet) {
    if (recipeNorm.some(r => r.includes(s) || s.includes(r))) hitCount++;
  }
  return hitCount / selectedSet.size >= 0.58; // –ø–æ—Ä–æ–≥ –º–æ–∂–Ω–æ –ø–æ–¥–≤–∏–Ω—É—Ç—å
}
async function showMatchingRecipes() {
  if (selected.size === 0) return;
  resultsEl.innerHTML = '';
  loaderEl.style.display = 'block';
  findBtn.disabled = true;
  try {
    const allRecipes = await loadAllRecipes();
    const matches = allRecipes.filter(r => matchesRecipe(r, selected));
    loaderEl.style.display = 'none';
    if (!matches.length) {
      resultsEl.innerHTML = `
        <div class="no-results">
          –ü–æ–¥—Ö–æ–¥—è—â–∏—Ö —Ä–µ—Ü–µ–ø—Ç–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ üòî<br><br>
          –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ—Ç–º–µ—Ç–∏—Ç—å –±–æ–ª—å—à–µ –ø—Ä–æ–¥—É–∫—Ç–æ–≤
        </div>`;
      return;
    }
    const catNames = {
      breakfast: "–ó–∞–≤—Ç—Ä–∞–∫",
      lunch: "–û–±–µ–¥",
      dinner: "–£–∂–∏–Ω",
      soups: "–°—É–ø—ã",
      dessert: "–î–µ—Å–µ—Ä—Ç"
    };
    matches.forEach(r => {
      const card = document.createElement('div');
      card.className = 'recipe-card';
      card.innerHTML = `
        <div class="recipe-title">${r.title || '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è'}</div>
        <div class="recipe-meta">
          ${catNames[r.category] || r.category} ‚Ä¢ ${r.time || '?'} –º–∏–Ω ‚Ä¢ ${r.calories || '?'} –∫–∫–∞–ª
        </div>
        <div class="plain-list">
          <strong>–ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã:</strong><br>
          ${r.ingredients.map(i => `‚Ä¢ ${i.trim()}`).join('<br>')}
        </div>
        <div class="plain-list">
          <strong>–ü—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏–µ:</strong><br>
          ${r.steps?.map((s,i) => `${i+1}. ${s.trim()}`).join('<br>') || '‚Äî'}
        </div>
        ${r.note ? `<div class="note"><strong>–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:</strong><br>${r.note.trim()}</div>` : ''}
      `;
      resultsEl.appendChild(card);
    });
  } catch (err) {
    console.error(err);
    loaderEl.style.display = 'none';
    resultsEl.innerHTML = '<div class="error">–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ä–µ—Ü–µ–ø—Ç—ã</div>';
  } finally {
    findBtn.disabled = false;
  }
}

async function checkAccess() {
  if (!pb.authStore.isValid) {
    authSection.style.display = 'block';
    mainContent.style.display = 'none';
    trialExpired.style.display = 'none';
    return false;
  }

  try {
    // –û–±–Ω–æ–≤–ª—è–µ–º –º–æ–¥–µ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
    await pb.collection('users').authRefresh();

    const user = pb.authStore.model;
    
    // –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º, —á—Ç–æ –≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ users –µ—Å—Ç—å –ø–æ–ª—è: 
    // - trial_start (datetime, –¥–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ —Ç—Ä–∏–∞–ª–∞)
    // - subscribed (boolean, –∞–∫—Ç–∏–≤–Ω–∞ –ª–∏ –ø–ª–∞—Ç–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞)
    // –ï—Å–ª–∏ –ø–æ–ª–µ–π –Ω–µ—Ç, –¥–æ–±–∞–≤—å—Ç–µ –∏—Ö –≤ PocketBase –∞–¥–º–∏–Ω–∫–µ.

    const trialStart = new Date(user.trial_start);
    const trialEnd = new Date(trialStart);
    trialEnd.setDate(trialEnd.getDate() + 3); // 3 –¥–Ω—è —Ç—Ä–∏–∞–ª–∞

    const now = new Date();
    const hasAccess = user.subscribed || (now < trialEnd && user.trial_start);

    if (hasAccess) {
      authSection.style.display = 'none';
      mainContent.style.display = 'block';
      trialExpired.style.display = 'none';
      renderIngredients();
      return true;
    } else {
      authSection.style.display = 'none';
      mainContent.style.display = 'none';
      trialExpired.style.display = 'block';
      return false;
    }
  } catch (err) {
    console.error('–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–∞:', err);
    pb.authStore.clear();
    checkAccess(); // –ü–æ–≤—Ç–æ—Ä–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å —Ñ–æ—Ä–º—É
    return false;
  }
}

async function handleAuth() {
  const email = emailInput.value.trim();
  const password = passwordInput.value.trim();

  if (!email || !password) {
    authError.textContent = '–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è';
    authError.style.display = 'block';
    return;
  }

  try {
    if (isRegisterMode) {
      // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
      const data = {
        email,
        password,
        passwordConfirm: password,
        trial_start: new Date().toISOString(), // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –¥–∞—Ç—É –Ω–∞—á–∞–ª–∞ —Ç—Ä–∏–∞–ª–∞
        subscribed: false // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –±–µ–∑ –ø–æ–¥–ø–∏—Å–∫–∏
      };
      await pb.collection('users').create(data);
      // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ª–æ–≥–∏–Ω –ø–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
      await pb.collection('users').authWithPassword(email, password);
    } else {
      // –õ–æ–≥–∏–Ω
      await pb.collection('users').authWithPassword(email, password);
    }

    authError.style.display = 'none';
    checkAccess();
  } catch (err) {
    authError.textContent = err.message || '–û—à–∏–±–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏';
    authError.style.display = 'block';
  }
}

function toggleMode() {
  isRegisterMode = !isRegisterMode;
  authBtn.textContent = isRegisterMode ? '–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è' : '–í–æ–π—Ç–∏';
  toggleAuth.innerHTML = isRegisterMode 
    ? '–£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? <span>–í–æ–π—Ç–∏</span>' 
    : '–ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? <span>–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</span>';
}

// ‚îÄ‚îÄ‚îÄ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
document.addEventListener('DOMContentLoaded', async () => {
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
  await checkAccess();

  authBtn.onclick = handleAuth;
  toggleAuth.onclick = toggleMode;
  findBtn.onclick = showMatchingRecipes;
  clearBtn.onclick = () => {
    selected.clear();
    document.querySelectorAll('#ingredientsList input').forEach(el => el.checked = false);
    findBtn.disabled = true;
    resultsEl.innerHTML = '';
  };
  logoutBtn.onclick = () => {
    pb.authStore.clear();
    checkAccess();
  };
});
</script>
</body>
</html>
